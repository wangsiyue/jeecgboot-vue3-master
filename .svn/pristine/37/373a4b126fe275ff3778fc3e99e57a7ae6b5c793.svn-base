{"version":3,"file":"index.js","sources":["../../src/scoring/index.ts"],"sourcesContent":[null],"names":["scoringHelper","password","optimal","excludeAdditive","fillArray","size","valueType","result","i","value","push","makeBruteforceMatch","j","pattern","token","slice","update","match","sequenceLength","k","estimatedMatch","estimateGuesses","pi","guesses","g","utils","factorial","MIN_GUESSES_BEFORE_GROWING_SEQUENCE","shouldSkip","Object","keys","forEach","competingPatternLength","competingMetricMatch","parseInt","m","bruteforceUpdate","passwordCharIndex","tmp","lastMatch","unwind","passwordLength","optimalMatchSequence","temp","candidateSequenceLength","candidateMetricMatch","unshift","mostGuessableMatchSequence","matches","length","matchesByCoordinateJ","map","sort","m1","m2","optimalSequenceLength","getGuesses","guessesLog10","log10","sequence"],"mappings":";;;;;;AAKA,MAAMA,aAAa,GAAG;AACpBC,EAAAA,QAAQ,EAAE,EADU;AAEpBC,EAAAA,OAAO,EAAE,EAFW;AAGpBC,EAAAA,eAAe,EAAE,KAHG;;AAIpBC,EAAAA,SAAS,CAACC,IAAD,EAAeC,SAAf,EAA4C;IACnD,MAAMC,MAAM,GAAuD,EAAnE,CAAA;;AACA,IAAA,KAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,IAApB,EAA0BG,CAAC,IAAI,CAA/B,EAAkC;MAChC,IAAIC,KAAK,GAAY,EAArB,CAAA;;MACA,IAAIH,SAAS,KAAK,QAAlB,EAA4B;AAC1BG,QAAAA,KAAK,GAAG,EAAR,CAAA;AACD,OAAA;;MACDF,MAAM,CAACG,IAAP,CAAYD,KAAZ,CAAA,CAAA;AACD,KAAA;;AACD,IAAA,OAAOF,MAAP,CAAA;GAbkB;;AAepB;AACAI,EAAAA,mBAAmB,CAACH,CAAD,EAAYI,CAAZ,EAAqB;IACtC,OAAO;AACLC,MAAAA,OAAO,EAAE,YADJ;AAELC,MAAAA,KAAK,EAAE,IAAA,CAAKb,QAAL,CAAcc,KAAd,CAAoBP,CAApB,EAAuB,CAACI,CAAD,GAAK,CAAL,IAAU,GAAjC,CAFF;MAGLJ,CAHK;AAILI,MAAAA,CAAAA;KAJF,CAAA;GAjBkB;;AAwBpB;AACA;AACA;AACAI,EAAAA,MAAM,CAACC,KAAD,EAAuBC,cAAvB,EAA6C;AACjD,IAAA,MAAMC,CAAC,GAAGF,KAAK,CAACL,CAAhB,CAAA;IACA,MAAMQ,cAAc,GAAGC,QAAe,CAACJ,KAAD,EAAQ,IAAA,CAAKhB,QAAb,CAAtC,CAAA;AACA,IAAA,IAAIqB,EAAE,GAAGF,cAAc,CAACG,OAAxB,CAAA;;IACA,IAAIL,cAAc,GAAG,CAArB,EAAwB;AACtB;AACA;AACA;AACA;AACAI,MAAAA,EAAE,IAAI,IAAA,CAAKpB,OAAL,CAAaoB,EAAb,CAAgBF,cAAc,CAACZ,CAAf,GAAmB,CAAnC,CAAA,CAAsCU,cAAc,GAAG,CAAvD,CAAN,CAAA;AACD,KAVgD;;;IAYjD,IAAIM,CAAC,GAAGC,KAAK,CAACC,SAAN,CAAgBR,cAAhB,IAAkCI,EAA1C,CAAA;;IACA,IAAI,CAAC,IAAKnB,CAAAA,eAAV,EAA2B;AACzBqB,MAAAA,CAAC,IAAIG,0CAAmC,KAAKT,cAAc,GAAG,CAAtB,CAAxC,CAAA;AACD,KAfgD;AAiBjD;AACA;AACA;;;IACA,IAAIU,UAAU,GAAG,KAAjB,CAAA;AACAC,IAAAA,MAAM,CAACC,IAAP,CAAY,IAAA,CAAK5B,OAAL,CAAasB,CAAb,CAAeL,CAAf,CAAZ,CAAA,CAA+BY,OAA/B,CAAwCC,sBAAD,IAA2B;MAChE,MAAMC,oBAAoB,GAAG,IAAA,CAAK/B,OAAL,CAAasB,CAAb,CAAeL,CAAf,CAAkBa,CAAAA,sBAAlB,CAA7B,CAAA;;MACA,IAAIE,QAAQ,CAACF,sBAAD,EAAyB,EAAzB,CAAR,IAAwCd,cAA5C,EAA4D;QAC1D,IAAIe,oBAAoB,IAAIT,CAA5B,EAA+B;AAC7BI,UAAAA,UAAU,GAAG,IAAb,CAAA;AACD,SAAA;AACF,OAAA;KANH,CAAA,CAAA;;IAQA,IAAI,CAACA,UAAL,EAAiB;AACf;MACA,IAAK1B,CAAAA,OAAL,CAAasB,CAAb,CAAeL,CAAf,CAAkBD,CAAAA,cAAlB,IAAoCM,CAApC,CAAA;MACA,IAAKtB,CAAAA,OAAL,CAAaiC,CAAb,CAAehB,CAAf,CAAkBD,CAAAA,cAAlB,IAAoCE,cAApC,CAAA;MACA,IAAKlB,CAAAA,OAAL,CAAaoB,EAAb,CAAgBH,CAAhB,CAAmBD,CAAAA,cAAnB,IAAqCI,EAArC,CAAA;AACD,KAAA;GA7DiB;;AAgEpB;EACAc,gBAAgB,CAACC,iBAAD,EAA0B;AACxC;IACA,IAAIpB,KAAK,GAAG,IAAKN,CAAAA,mBAAL,CAAyB,CAAzB,EAA4B0B,iBAA5B,CAAZ,CAAA;AACA,IAAA,IAAA,CAAKrB,MAAL,CAAYC,KAAZ,EAAmB,CAAnB,CAAA,CAAA;;AACA,IAAA,KAAK,IAAIT,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAI6B,iBAArB,EAAwC7B,CAAC,IAAI,CAA7C,EAAgD;AAC9C;AACA;AACA;AACAS,MAAAA,KAAK,GAAG,IAAKN,CAAAA,mBAAL,CAAyBH,CAAzB,EAA4B6B,iBAA5B,CAAR,CAAA;AACA,MAAA,MAAMC,GAAG,GAAG,IAAKpC,CAAAA,OAAL,CAAaiC,CAAb,CAAe3B,CAAC,GAAG,CAAnB,CAAZ,CAL8C;;MAO9CqB,MAAM,CAACC,IAAP,CAAYQ,GAAZ,EAAiBP,OAAjB,CAA0Bb,cAAD,IAAmB;AAC1C,QAAA,MAAMqB,SAAS,GAAGD,GAAG,CAACpB,cAAD,CAArB,CAD0C;AAG1C;AACA;AACA;;AACA,QAAA,IAAIqB,SAAS,CAAC1B,OAAV,KAAsB,YAA1B,EAAwC;AACtC;UACA,IAAKG,CAAAA,MAAL,CAAYC,KAAZ,EAAmBiB,QAAQ,CAAChB,cAAD,EAAiB,EAAjB,CAAR,GAA+B,CAAlD,CAAA,CAAA;AACD,SAAA;OATH,CAAA,CAAA;AAWD,KAAA;GAvFiB;;AA0FpB;AACA;EACAsB,MAAM,CAACC,cAAD,EAAuB;IAC3B,MAAMC,oBAAoB,GAAqB,EAA/C,CAAA;AACA,IAAA,IAAIvB,CAAC,GAAGsB,cAAc,GAAG,CAAzB,CAF2B;;AAI3B,IAAA,IAAIvB,cAAc,GAAG,CAArB,CAJ2B;;IAM3B,IAAIM,CAAC,GAAG,KAAR,CAAA;IACA,MAAMmB,IAAI,GAAG,IAAA,CAAKzC,OAAL,CAAasB,CAAb,CAAeL,CAAf,CAAb,CAP2B;;AAS3B,IAAA,IAAIwB,IAAJ,EAAU;MACRd,MAAM,CAACC,IAAP,CAAYa,IAAZ,EAAkBZ,OAAlB,CAA2Ba,uBAAD,IAA4B;AACpD,QAAA,MAAMC,oBAAoB,GAAGF,IAAI,CAACC,uBAAD,CAAjC,CAAA;;QACA,IAAIC,oBAAoB,GAAGrB,CAA3B,EAA8B;AAC5BN,UAAAA,cAAc,GAAGgB,QAAQ,CAACU,uBAAD,EAA0B,EAA1B,CAAzB,CAAA;AACApB,UAAAA,CAAC,GAAGqB,oBAAJ,CAAA;AACD,SAAA;OALH,CAAA,CAAA;AAOD,KAAA;;IACD,OAAO1B,CAAC,IAAI,CAAZ,EAAe;MACb,MAAMF,KAAK,GAAmB,IAAA,CAAKf,OAAL,CAAaiC,CAAb,CAAehB,CAAf,CAAkBD,CAAAA,cAAlB,CAA9B,CAAA;MACAwB,oBAAoB,CAACI,OAArB,CAA6B7B,KAA7B,CAAA,CAAA;AACAE,MAAAA,CAAC,GAAGF,KAAK,CAACT,CAAN,GAAU,CAAd,CAAA;AACAU,MAAAA,cAAc,IAAI,CAAlB,CAAA;AACD,KAAA;;AACD,IAAA,OAAOwB,oBAAP,CAAA;AACD,GAAA;;AArHmB,CAAtB,CAAA;AAwHA,cAAe;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACAK,0BAA0B,CACxB9C,QADwB,EAExB+C,OAFwB,EAGxB7C,eAAe,GAAG,KAHM,EAGD;IAEvBH,aAAa,CAACC,QAAd,GAAyBA,QAAzB,CAAA;IACAD,aAAa,CAACG,eAAd,GAAgCA,eAAhC,CAAA;AACA,IAAA,MAAMsC,cAAc,GAAGxC,QAAQ,CAACgD,MAAhC,CAJuB;;IAMvB,IAAIC,oBAAoB,GAAGlD,aAAa,CAACI,SAAd,CACzBqC,cADyB,EAEzB,OAFyB,CAA3B,CAAA;AAKAO,IAAAA,OAAO,CAACjB,OAAR,CAAiBd,KAAD,IAAU;MACxBiC,oBAAoB,CAACjC,KAAK,CAACL,CAAP,CAApB,CAA8BF,IAA9B,CAAmCO,KAAnC,CAAA,CAAA;AACD,KAFD,EAXuB;;IAevBiC,oBAAoB,GAAGA,oBAAoB,CAACC,GAArB,CAA0BlC,KAAD,IAC9CA,KAAK,CAACmC,IAAN,CAAW,CAACC,EAAD,EAAoBC,EAApB,KAA0CD,EAAE,CAAC7C,CAAH,GAAO8C,EAAE,CAAC9C,CAA/D,CADqB,CAAvB,CAAA;IAIAR,aAAa,CAACE,OAAd,GAAwB;AACtB;AACA;AACA;AACA;AACA;AACA;MACAiC,CAAC,EAAEnC,aAAa,CAACI,SAAd,CAAwBqC,cAAxB,EAAwC,QAAxC,CAPmB;AAQtB;AACA;MACAnB,EAAE,EAAEtB,aAAa,CAACI,SAAd,CAAwBqC,cAAxB,EAAwC,QAAxC,CAVkB;AAWtB;AACAjB,MAAAA,CAAC,EAAExB,aAAa,CAACI,SAAd,CAAwBqC,cAAxB,EAAwC,QAAxC,CAAA;KAZL,CAAA;;AAeA,IAAA,KAAK,IAAItB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsB,cAApB,EAAoCtB,CAAC,IAAI,CAAzC,EAA4C;AAC1C+B,MAAAA,oBAAoB,CAAC/B,CAAD,CAApB,CAAwBY,OAAxB,CAAiCd,KAAD,IAAyB;AACvD,QAAA,IAAIA,KAAK,CAACT,CAAN,GAAU,CAAd,EAAiB;AACfqB,UAAAA,MAAM,CAACC,IAAP,CAAY9B,aAAa,CAACE,OAAd,CAAsBiC,CAAtB,CAAwBlB,KAAK,CAACT,CAAN,GAAU,CAAlC,CAAZ,EAAkDuB,OAAlD,CACGb,cAAD,IAAmB;AACjBlB,YAAAA,aAAa,CAACgB,MAAd,CAAqBC,KAArB,EAA4BiB,QAAQ,CAAChB,cAAD,EAAiB,EAAjB,CAAR,GAA+B,CAA3D,CAAA,CAAA;WAFJ,CAAA,CAAA;AAKD,SAND,MAMO;AACLlB,UAAAA,aAAa,CAACgB,MAAd,CAAqBC,KAArB,EAA4B,CAA5B,CAAA,CAAA;AACD,SAAA;OATH,CAAA,CAAA;MAWAjB,aAAa,CAACoC,gBAAd,CAA+BjB,CAA/B,CAAA,CAAA;AACD,KAAA;;AACD,IAAA,MAAMuB,oBAAoB,GAAG1C,aAAa,CAACwC,MAAd,CAAqBC,cAArB,CAA7B,CAAA;AACA,IAAA,MAAMc,qBAAqB,GAAGb,oBAAoB,CAACO,MAAnD,CAAA;IACA,MAAM1B,OAAO,GAAG,IAAKiC,CAAAA,UAAL,CAAgBvD,QAAhB,EAA0BsD,qBAA1B,CAAhB,CAAA;IACA,OAAO;MACLtD,QADK;MAELsB,OAFK;AAGLkC,MAAAA,YAAY,EAAEhC,KAAK,CAACiC,KAAN,CAAYnC,OAAZ,CAHT;AAILoC,MAAAA,QAAQ,EAAEjB,oBAAAA;KAJZ,CAAA;GAvFW;;AA+Fbc,EAAAA,UAAU,CAACvD,QAAD,EAAmBsD,qBAAnB,EAAgD;AACxD,IAAA,MAAMd,cAAc,GAAGxC,QAAQ,CAACgD,MAAhC,CAAA;IACA,IAAI1B,OAAO,GAAG,CAAd,CAAA;;AACA,IAAA,IAAItB,QAAQ,CAACgD,MAAT,KAAoB,CAAxB,EAA2B;AACzB1B,MAAAA,OAAO,GAAG,CAAV,CAAA;AACD,KAFD,MAEO;AACLA,MAAAA,OAAO,GACLvB,aAAa,CAACE,OAAd,CAAsBsB,CAAtB,CAAwBiB,cAAc,GAAG,CAAzC,CAA4Cc,CAAAA,qBAA5C,CADF,CAAA;AAED,KAAA;;AACD,IAAA,OAAOhC,OAAP,CAAA;AACD,GAAA;;AAzGY,CAAf;;;;"}