{
  "version": 3,
  "sources": ["../../@jeecg/online/OnlineSelectCascade.js"],
  "sourcesContent": ["var __async = (__this, __arguments, generator) => {\n  return new Promise((resolve, reject) => {\n    var fulfilled = (value) => {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var rejected = (value) => {\n      try {\n        step(generator.throw(value));\n      } catch (e) {\n        reject(e);\n      }\n    };\n    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);\n    step((generator = generator.apply(__this, __arguments)).next());\n  });\n};\nimport { defineComponent, ref, watch, resolveComponent, openBlock, createBlock, withCtx, createElementBlock, Fragment, renderList, createElementVNode, toDisplayString } from \"vue\";\nimport { defHttp } from \"/@/utils/http/axios\";\nimport { useMessage } from \"/@/hooks/web/useMessage\";\nimport { _ as _export_sfc } from \"./index.js\";\nimport \"/@/components/jeecg/OnLine/JPopupOnlReport.vue\";\nimport \"vue-router\";\nconst SELECT_OPTIONS_URL = \"/online/cgform/api/querySelectOptions\";\nconst _sfc_main = defineComponent({\n  name: \"OnlineSelectCascade\",\n  props: {\n    table: { type: String, default: \"\" },\n    txt: { type: String, default: \"\" },\n    store: { type: String, default: \"\" },\n    idField: { type: String, default: \"\" },\n    pidField: { type: String, default: \"\" },\n    pidValue: { type: String, default: \"-1\" },\n    origin: { type: Boolean, default: false },\n    condition: { type: String, default: \"\" },\n    value: { type: String, default: \"\" },\n    isNumber: { type: Boolean, default: false },\n    placeholder: { type: String, default: \"\\u8BF7\\u9009\\u62E9\" }\n  },\n  emits: [\"change\", \"next\"],\n  setup(props, { emit }) {\n    const { createMessage: $message } = useMessage();\n    const selectedValue = ref(\"\");\n    const dictOptions = ref([]);\n    const optionsLoad = ref(true);\n    function handleChange(value) {\n      console.log(\"handleChange\", value);\n      let temp = value || \"\";\n      emit(\"change\", temp);\n      valueChangeThenEmitNext(temp);\n    }\n    watch(() => props.condition, (val) => {\n      optionsLoad.value = true;\n      if (val) {\n        loadOptions();\n      }\n    }, { immediate: true });\n    watch(() => props.pidValue, (val) => {\n      if (val === \"-1\") {\n        dictOptions.value = [];\n      } else {\n        loadOptions();\n      }\n    });\n    watch(() => props.value, (newVal, oldVal) => {\n      console.log(\"\\u503C\\u6539\\u53D8\\u4E8B\\u4EF6\", newVal, oldVal);\n      if (!newVal) {\n        selectedValue.value = [];\n        if (oldVal) {\n          emit(\"change\", \"\");\n          emit(\"next\", \"-1\");\n        }\n      } else {\n        selectedValue.value = newVal;\n      }\n      if (newVal && !oldVal) {\n        handleFirstValueSetting(newVal);\n      }\n    }, { immediate: true });\n    function handleFirstValueSetting(value) {\n      return __async(this, null, function* () {\n        if (props.idField === props.store) {\n          emit(\"next\", value);\n        } else {\n          if (props.origin === true) {\n            yield getSelfOptions();\n            valueChangeThenEmitNext(value);\n          } else {\n            let arr = yield loadValueText();\n            valueChangeThenEmitNext(value, arr);\n          }\n        }\n      });\n    }\n    function loadOptions() {\n      let params = getQueryParams();\n      if (props.origin === true) {\n        params[\"condition\"] = props.condition;\n      } else {\n        params[\"pidValue\"] = props.pidValue;\n      }\n      console.log(\"\\u8BF7\\u6C42\\u53C2\\u6570\", params);\n      dictOptions.value = [];\n      defHttp.get({ url: SELECT_OPTIONS_URL, params }, { isTransformResponse: false }).then((res) => {\n        if (res.success) {\n          dictOptions.value = [...res.result];\n          console.log(\"\\u8BF7\\u6C42\\u7ED3\\u679C\", res.result, dictOptions);\n        } else {\n          $message.warning(\"\\u8054\\u52A8\\u7EC4\\u4EF6\\u6570\\u636E\\u52A0\\u8F7D\\u5931\\u8D25,\\u8BF7\\u68C0\\u67E5\\u914D\\u7F6E!\");\n        }\n      });\n    }\n    function getQueryParams() {\n      let params = {\n        table: props.table,\n        txt: props.txt,\n        key: props.store,\n        idField: props.idField,\n        pidField: props.pidField\n      };\n      return params;\n    }\n    function loadValueText() {\n      return new Promise((resolve) => {\n        if (!props.value) {\n          selectedValue.value = [];\n          resolve([]);\n        } else {\n          let params = getQueryParams();\n          if (props.isNumber === true) {\n            params[\"condition\"] = `${props.store} = ${props.value}`;\n          } else {\n            params[\"condition\"] = `${props.store} = '${props.value}'`;\n          }\n          defHttp.get({ url: SELECT_OPTIONS_URL, params }, { isTransformResponse: false }).then((res) => {\n            if (res.success) {\n              resolve(res.result);\n            } else {\n              $message.warning(\"\\u8054\\u52A8\\u7EC4\\u4EF6\\u6570\\u636E\\u52A0\\u8F7D\\u5931\\u8D25,\\u8BF7\\u68C0\\u67E5\\u914D\\u7F6E!\");\n              resolve([]);\n            }\n          });\n        }\n      });\n    }\n    function getSelfOptions() {\n      return new Promise((resolve) => {\n        let index = 0;\n        (function next(index2) {\n          if (index2 > 10) {\n            resolve([]);\n          }\n          let arr = dictOptions.value;\n          if (arr && arr.length > 0) {\n            resolve(arr);\n          } else {\n            setTimeout(() => {\n              next(index2++);\n            }, 300);\n          }\n        })(index);\n      });\n    }\n    function valueChangeThenEmitNext(value, arr = []) {\n      if (value && value.length > 0) {\n        if (!arr || arr.length == 0) {\n          arr = dictOptions.value;\n        }\n        let selected = arr.filter((item) => item.store === value);\n        if (selected && selected.length > 0) {\n          let id = selected[0].id;\n          emit(\"next\", id);\n        }\n      }\n    }\n    return {\n      selectedValue,\n      dictOptions,\n      handleChange\n    };\n  }\n});\nconst _hoisted_1 = [\"title\"];\nfunction _sfc_render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_a_select_option = resolveComponent(\"a-select-option\");\n  const _component_a_select = resolveComponent(\"a-select\");\n  return openBlock(), createBlock(_component_a_select, {\n    placeholder: _ctx.placeholder,\n    value: _ctx.selectedValue,\n    onChange: _ctx.handleChange,\n    allowClear: \"\",\n    style: { \"width\": \"100%\" }\n  }, {\n    default: withCtx(() => [\n      (openBlock(true), createElementBlock(Fragment, null, renderList(_ctx.dictOptions, (item, index) => {\n        return openBlock(), createBlock(_component_a_select_option, {\n          key: index,\n          value: item.store\n        }, {\n          default: withCtx(() => [\n            createElementVNode(\"span\", {\n              style: { \"display\": \"inline-block\", \"width\": \"100%\" },\n              title: item.label\n            }, toDisplayString(item.label), 9, _hoisted_1)\n          ]),\n          _: 2\n        }, 1032, [\"value\"]);\n      }), 128))\n    ]),\n    _: 1\n  }, 8, [\"placeholder\", \"value\", \"onChange\"]);\n}\nvar OnlineSelectCascade = /* @__PURE__ */ _export_sfc(_sfc_main, [[\"render\", _sfc_render]]);\nexport { OnlineSelectCascade as default };\n"],
  "mappings": "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",
  "names": []
}
